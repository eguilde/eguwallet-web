---
interface Props { currentLang: string; }
const { currentLang } = Astro.props;

const LANGS: [string, string, string][] = [
  ['ro','RO','ğŸ‡·ğŸ‡´'], ['en','EN','ğŸ‡¬ğŸ‡§'], ['de','DE','ğŸ‡©ğŸ‡ª'],
  ['fr','FR','ğŸ‡«ğŸ‡·'], ['es','ES','ğŸ‡ªğŸ‡¸'], ['it','IT','ğŸ‡®ğŸ‡¹'],
  ['pl','PL','ğŸ‡µğŸ‡±'], ['pt','PT','ğŸ‡µğŸ‡¹'], ['hu','HU','ğŸ‡­ğŸ‡º'],
  ['cs','CS','ğŸ‡¨ğŸ‡¿'], ['sk','SK','ğŸ‡¸ğŸ‡°'], ['bg','BG','ğŸ‡§ğŸ‡¬'],
  ['hr','HR','ğŸ‡­ğŸ‡·'], ['lt','LT','ğŸ‡±ğŸ‡¹'], ['lv','LV','ğŸ‡±ğŸ‡»'],
  ['et','ET','ğŸ‡ªğŸ‡ª'], ['mt','MT','ğŸ‡²ğŸ‡¹'], ['sl','SL','ğŸ‡¸ğŸ‡®'],
  ['sv','SV','ğŸ‡¸ğŸ‡ª'], ['da','DA','ğŸ‡©ğŸ‡°'], ['nl','NL','ğŸ‡³ğŸ‡±'],
  ['el','EL','ğŸ‡¬ğŸ‡·'], ['fi','FI','ğŸ‡«ğŸ‡®'], ['ga','GA','ğŸ‡®ğŸ‡ª'],
];

const current = LANGS.find(([l]) => l === currentLang) ?? ['en','EN','ğŸ‡¬ğŸ‡§'];
---
<div class="relative" id="lang-selector">
  <button
    id="lang-btn"
    aria-haspopup="listbox"
    aria-expanded="false"
    class="flex items-center gap-1.5 h-8 px-2 rounded-md text-[13px] font-medium t-fg border t-border cursor-pointer hover:opacity-80 transition-opacity"
    title="Select language"
  >
    <span class="text-base leading-none" aria-hidden="true">{current[2]}</span>
    <span class="font-semibold tracking-wide">{current[1]}</span>
    <svg class="w-3 h-3 opacity-40" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7"/></svg>
  </button>

  <ul
    id="lang-menu"
    role="listbox"
    aria-label="Select language"
    class="absolute right-0 top-full mt-1.5 z-50 hidden rounded-lg shadow-xl overflow-y-auto py-1 t-bg-surface border t-border"
    style="width: 88px; max-height: 280px;"
  >
    {LANGS.map(([loc, code, flag]) => (
      <li role="option" aria-selected={loc === currentLang}>
        <a
          href={`/${loc}/`}
          class={`flex items-center gap-2 px-3 py-1.5 text-[13px] hover:opacity-100 transition-opacity ${loc === currentLang ? 't-primary font-semibold' : 't-fg opacity-70'}`}
        >
          <span class="text-base leading-none" aria-hidden="true">{flag}</span>
          <span class="font-medium">{code}</span>
        </a>
      </li>
    ))}
  </ul>
</div>

<script>
  const btn = document.getElementById('lang-btn');
  const menu = document.getElementById('lang-menu');
  btn?.addEventListener('click', (e) => {
    e.stopPropagation();
    const open = menu?.classList.toggle('hidden') === false;
    btn.setAttribute('aria-expanded', String(open));
  });
  document.addEventListener('click', () => {
    menu?.classList.add('hidden');
    btn?.setAttribute('aria-expanded', 'false');
  });
</script>
