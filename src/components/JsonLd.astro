---
import { SITE } from '../config/site.ts';
interface Props { lang: string; faqItems: {q:string; a:string}[]; }
const { lang, faqItems } = Astro.props;

const BCP47: Record<string, string> = {
  ro:'ro-RO', en:'en-GB', de:'de-DE', fr:'fr-FR', es:'es-ES',
  it:'it-IT', pl:'pl-PL', pt:'pt-PT', hu:'hu-HU', cs:'cs-CZ',
  sk:'sk-SK', bg:'bg-BG', hr:'hr-HR', lt:'lt-LT', lv:'lv-LV',
  et:'et-EE', mt:'mt-MT', sl:'sl-SI', sv:'sv-SE', da:'da-DK',
  nl:'nl-NL', el:'el-GR', fi:'fi-FI', ga:'ga-IE',
};
const inLanguage = BCP47[lang] ?? lang;

const softwareApp = {
  '@context':'https://schema.org',
  '@type':'SoftwareApplication',
  'name':'EguWallet',
  'operatingSystem':'Android',
  'applicationCategory':'UtilitiesApplication',
  'inLanguage': inLanguage,
  'offers':{'@type':'Offer','price':'0','priceCurrency':'EUR','availability':'https://schema.org/InStock'},
  'description':'EUDI Wallet compliant with eIDAS 2.0 — European digital identity wallet. Store and present your ID card, passport, driving licence and more.',
  'url':SITE,
  'downloadUrl':'https://play.google.com/store/apps/details?id=com.eguwallet.wallet',
  'author':{'@type':'Organization','name':'IT Eguilde SRL'},
  'featureList': [
    'eIDAS 2.0 compliant digital identity',
    'Selective disclosure via SD-JWT',
    'ISO 18013-5 mDoc support',
    'OpenID4VCI / OpenID4VP',
    'GDPR Art. 17 right to erasure',
    'Qualified Electronic Signature (QES)',
  ],
};

const organization = {
  '@context':'https://schema.org',
  '@type':'Organization',
  'name':'IT Eguilde SRL',
  'url':SITE,
  'logo':`${SITE}/assets/logo-shield.svg`,
  'email':'contact@eguwallet.eu',
  'address':{
    '@type':'PostalAddress',
    'streetAddress':'B-dul Pache Protopopescu nr. 89',
    'addressLocality':'București',
    'addressRegion':'Sector 2',
    'postalCode':'021408',
    'addressCountry':'RO',
  },
  'sameAs':[],
};

const website = {
  '@context':'https://schema.org',
  '@type':'WebSite',
  'name':'EguWallet',
  'url':SITE,
  'inLanguage': inLanguage,
};

const faqPage = {
  '@context':'https://schema.org',
  '@type':'FAQPage',
  'inLanguage': inLanguage,
  'mainEntity': faqItems.map(({q,a}) => ({
    '@type':'Question',
    'name': q,
    'acceptedAnswer':{'@type':'Answer','text': a},
  })),
};
---
<script type="application/ld+json" is:inline set:html={JSON.stringify(softwareApp)} />
<script type="application/ld+json" is:inline set:html={JSON.stringify(organization)} />
<script type="application/ld+json" is:inline set:html={JSON.stringify(website)} />
{faqItems.length > 0 && <script type="application/ld+json" is:inline set:html={JSON.stringify(faqPage)} />}
